<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Credential Dumping with Mimikatz</title>
</head><body><b><u><div style="text-align: center"><span style="font-size: 20pt">Credential Dumping with Mimikatz</span></div><br/>
</u></b><br/>
<br/>
<span style="font-size: 15pt">This is a Post-Exploitation of the Domain Controller:</span>&nbsp;<br/>
<br/>
<span style="font-size: 15pt">First of all, we need to Download Mimikatz on the Domain Controller<br/>
(Suggest to read the Wiki on Github)<br/>
</span><img src="1.png" /><br/>
<br/>
<br/>
<br/>
<span style="font-size: 15pt">Execute Mimikatz (with your accurate architecture):<br/>
</span><img src="1 2.png" /><span style="font-size: 15pt"><br/>
</span><span style="font-size: 15pt"><br/>
<br/>
We need to load a module (privilege::debug) <br/>
to know if we can bypass the memory protection:<br/>
</span><img src="1 3.png" /><span style="font-size: 15pt"><br/>
</span><span style="font-size: 15pt"><br/>
</span><br/>
<span style="font-size: 15pt">If it is OK, we can do this.<br/>
Now we can catch all the password dumped in memory<br/>
From the login since the last reboot.<br/>
<u><b>Another interesting thing is that we have a NTLM hash and we can pass that!!</b></u><br/>
</span><img src="1 4.png" /><br/>
<br/>
<img src="1 5.png" /><br/>
<br/>
<br/>
<img src="1 6.png" /><br/>
<br/>
<br/>
<br/>
<span style="font-size: 15pt">We can take the Administrator hash over there and pass to a Domain Controller, if we were into another PC!<br/>
</span><br/>
<br/>
<br/>
<span style="font-size: 15pt">Another cool thing is the <b>wdigest: a feature enable by default in Windows 7 and before<br/>
</b></span><b><span style="font-size: 15pt">that stored your password in clear!!</span><br/>
</b><img src="1 7.png" /><br/>
<br/>
<br/>
<br/>
<span style="font-size: 15pt"><b>In Windows 10/8 wdigest is disabled, but we can turn it on with Mimikatz!!!<br/>
</b>It is a registry feature, so it will be enabled even if the machine is reboot.<br/>
But we still need to wait for someone to log out and log in.<br/>
<br/>
<br/>
<br/>
<br/>
For now, we can try to dump the SAM (not all commands can work)<br/>
In this case we got an error<br/>
</span><img src="1 8.png" /><br/>
<br/>
<img src="1 9.png" /><br/>
<br/>
<br/>
<span style="font-size: 15pt">Just because we didn't dump with Mimikatz, doesn't mean that we can't obtain it with other ways<br/>
<b>(Metasploit to get a shell, secretsdump.py etc.)<br/>
<br/>
<br/>
</b>We can try to dump the <b>LSA (Local Security Authority)</b>:<br/>
LSA is a protected subsystem in Windows authentication,<br/>
authenticate and create log of sessions on your local computer.<br/>
We can obtain the NTLM hashes and try to crack them offline<br/>
</span><img src="1 10.png" /><span style="font-size: 15pt"><br/>
</span><span style="font-size: 15pt"><br/>
<br/>
Another option is to dump the <b>NTDS.dit (Look at "Active Directory Physical Components" to know more)<br/>
</b><b><br/>
</b>You need to count how many hashes you cracked in %, to notice the client how the password policy is working</span></body></html>