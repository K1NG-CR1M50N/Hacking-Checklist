<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Enviroment Variables</title>
</head><body>Enviroment variables are variables set to the enviroment, so everyone can use it.<br/>
<br/>
We can see them with the <b>env</b>&nbsp;command:<br/>
<img src="env command.png" /><br/>
<br/>
<br/>
<b>The idea is to change some variables to escalate<br/>
<br/>
</b>Looking for SUID files<b>, </b>we can see 2 file for the enviroment (in this case are handmade)<br/>
<img src="suid suid-env.png" /><br/>
<br/>
<br/>
We can try to run the first one and see what happen:<br/>
<br/>
<img src="suid-env run.png" /><br/>
<br/>
<br/>
To get a general overview of what a binary do, we can use the <b>strings</b>&nbsp;command.<br/>
Strings print at least 4 char at time that are writable.<br/>
<b>As we can see, he is trying to start the apache2 server.</b><br/>
<img src="strings suid-env.png" /><br/>
<br/>
The point is: we can execute the <b>service command </b>because into $PATH variable<br/>
there is the path related to <b>service</b>.<br/>
<br/>
<b>WHAT IF WE CAN CREATE A MALICIOUS "SERVICE" COMMAND IN ANOTHER PATH??<br/>
<br/>
<br/>
</b>To archive that, we are going to use a <b>oneliner C command and compile it:<br/>
</b><img src="malicious service.png" /><b><br/>
</b><b><br/>
<br/>
In order to execute that malicious service, we need to edit $PATH and add the path of our malicious file:<br/>
This is CRUCIAL.<br/>
We are echoing /tmp before the /usr/local/bin path, this way will execute our "service" before the original one!<br/>
</b><img src="echo path.png" /><br/>
<br/>
<br/>
Now we can execute our suid-env and we are<b>&nbsp;root!</b><br/>
<img src="suid-env exploit.png" /><br/>
</body></html>