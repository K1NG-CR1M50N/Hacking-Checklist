<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Shared Objects Injection</title>
</head><body>When we search for SUID, we can have <br/>
<img src="suid shared object.png" /><br/>
<br/>
<b><br/>
</b>We have a bunch of items from root and staff with "s" bit set for user and group.<b><br/>
</b>If we try to execute <b>suid-so</b>, it says:<b><br/>
</b><b><img src="suid shared object executed.png" /><br/>
</b><br/>
<br/>
To know more about what is going on behind the scene, we can use a tool called <b>strace:<br/>
</b><b>this tool is going to trace what is going on behind the scene.<br/>
</b><br/>
<b>Definition from man:</b><br/>
strace is a useful diagnostic, instructional, and debugging tool. &nbsp;System administrators, diagnosticians and trouble-shooters &nbsp;will<br/>
find &nbsp;it &nbsp;invaluable &nbsp;for solving problems with programs for which the source is not readily available since they do not need to be<br/>
recompiled in order to trace them. Students, hackers and the overly-curious will find that a great deal can &nbsp;be &nbsp;learned &nbsp;about &nbsp;a<br/>
system &nbsp;and &nbsp;its system calls by tracing even ordinary programs. &nbsp;And programmers will find that since system calls and signals are<br/>
events that happen at the user/kernel interface, a close examination of this boundary is very &nbsp;useful &nbsp;for &nbsp;bug &nbsp;isolation, &nbsp;sanity<br/>
checking and attempting to capture race conditions.<br/>
<br/>
<br/>
<b>We can search for some missing .so files, to inject them!<br/>
<br/>
</b><b>strace /usr/local/bin/suid-so 2&gt;&amp;1 | grep -i -E "open|access|no such file"</b><br/>
<img src="strace missing so.png" /><br/>
<br/>
<br/>
As we can see, a lot of .so (shared objects) are missing.<br/>
We can create our own <b>libcalc.so!<br/>
</b><b><br/>
First of all, we should check if we have the permissions to create a libcalc.so in that directory.<br/>
We should check the permission of that directory.<br/>
</b>In this case, it is located in our home folder, so we have!<b><br/>
</b><img src="directory per m for so injection.png" /><br/>
<br/>
<br/>
<b>Now we just need to create the .config directory and the libcalc.so!<br/>
</b><img src="mkdir.png" /><br/>
<br/>
<br/>
Now with nano we can create a <b>libcalc.c:<br/>
</b><img src="libcalc.png.png" /><br/>
<br/>
<br/>
We need to compile:<br/>
<img src="libcalc compiled.png" /><br/>
<br/>
<br/>
<br/>
<br/>
At the end, we need to execute the SUID object: this way will run our .so!!<br/>
<img src="suid so exploit.png" /></body></html>