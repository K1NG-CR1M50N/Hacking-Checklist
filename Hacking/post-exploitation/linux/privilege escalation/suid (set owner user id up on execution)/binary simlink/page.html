<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Binary Simlink</title>
</head><body><a href="http://legalhackers.com/advisories/Nginx-Exploit-Deb-Root-PrivEsc-CVE-2016-1247.html">http://legalhackers.com/advisories/Nginx-Exploit-Deb-Root-PrivEsc-CVE-2016-1247.html</a><br/>
<br/>
This is kind of vulnerability using NGINX and SUID.<br/>
The exploit is about the NGINX logs: with elevated privileges on logs<br/>
an attacker can escalate to root.<br/>
<br/>
Most web servers are hosted as www-data user:<br/>
<img src="www-data.png" /><br/>
<br/>
<br/>
If we can try to run the Linux Exploit suggester:<br/>
<img src="linux exploit suggester.png" /><br/>
<br/>
<br/>
We can check manually for the version of nginx with dpkg -l:<br/>
<img src="nginx version.png" /><br/>
<br/>
<br/>
<br/>
This exploit to work require the SUID on sudo:<br/>
We should check for it.<br/>
<img src="sudo suid.png" /><br/>
<br/>
<br/>
<br/>
Let's get started.<br/>
In the log folder we have read, write and execute permission<br/>
First step is to check the nginx log files: we can see some related to root!<br/>
<img src="nginx logs 2.png" /><br/>
<br/>
<br/>
The logic is this:<br/>
we can create a <b>symlink related to the log file, restart nginx and escalate!</b><br/>
Open the link and try to use the <b>PROOF OF CONCEPT EXPLOIT<br/>
</b><img src="nginx exploit 1.png" /><b><br/>
</b><b><br/>
</b><img src="nginx exploit 2.png" /><br/>
<br/>
<br/>
Last step is to restart nginx:<br/>
<img src="nginx success 1.png" /><br/>
<br/>
<img src="nginx success 2.png" /></body></html>