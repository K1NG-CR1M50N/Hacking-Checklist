<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>LLMNR Poisoning Theory</title>
</head><body><b><u><div style="text-align: center"><span style="font-size: 20pt">LLMNR Poisoning Overview</span></div></u></b><span style="font-size: 15pt"><br/>
</span><span style="font-size: 15pt"><br/>
<br/>
Link-Local Multicast Name Resolution &nbsp;(LLMNR)<br/>
</span><img src="1.png" width="950" height="555" /><br/>
<br/>
<br/>
<span style="font-size: 15pt"><br/>
The attack goes this way:<br/>
1) The victim ask for a Domain Name <b>(E.G. \\hackme)</b>&nbsp;but type it wrong <b>(E.G. \\hackm)</b>: the DNS says that can't resolve that<br/>
2) The Victim send a BROADCAST message to the network like <b>"Do anybody know where is this Domain?"<br/>
</b><b>3) </b>Us, listening in the middle <b>(MITM) </b>we say: <b>"I know where it is, give me YOUR HASH and I will connect you!!"<br/>
</b>4) The Victim send us the hashes!!!<br/>
<img src="1 2.png" width="950" height="535" /><br/>
</span><br/>
<br/>
<br/>
<br/>
<div style="text-align: center"><span style="font-size: 20pt"><u><b>LLMNR Poisoning Steps<br/>
<br/>
</b></u></span></div><span style="font-size: 20pt"><u><b><div style="text-align: left">Step 1: Run Responder (from Impacket)<br/>
<br/>
</div></b></u></span><div style="text-align: left"><span style="font-size: 15pt">The first thing to do is to run this scipt as soon as possible (E.G. At 8:00) or when it is a lot of traffic (Lunch Time)<br/>
</span><span style="font-size: 15pt">We can start that before every <b>nmap</b>&nbsp;or <b>nessus</b>&nbsp;can, so we have a lot of time</span><b><u><span style="font-size: 20pt"><br/>
</span></u></b></div><img src="1 3.png" width="950" height="558" /><br/>
<br/>
<br/>
<br/>
<b><u><span style="font-size: 20pt"><div style="text-align: left">Step 2: An event occurred...<br/>
</div></span></u></b><div style="text-align: left"><span style="font-family: sans"><span style="font-size: 16pt">Someone typed the wrong address or the wrong Domain (everything that can make a DNS failed request)<br/>
</span></span><img src="2.png" /><span style="font-size: 20pt"><b><u><br/>
</u></b></span><span style="font-size: 20pt"><b><u><br/>
<br/>
Step 3: Get the Hashes<br/>
<br/>
</u></b></span><span style="font-size: 15pt">Once we get the Hash, we can do a lot of attack (like trying to crack it)<br/>
</span><img src="1 4.png" width="950" height="575" /><br/>
<br/>
<br/>
<span style="font-size: 20pt"><u><b><br/>
Step 4: Try to crack the Hashes<br/>
<br/>
</b></u></span><span style="font-size: 15pt">We will use a tool called <u><b>hashcat<br/>
</b></u></span></div><img src="1 5.png" /><div style="text-align: left"><b><u><span style="font-size: 15pt"><br/>
</span></u></b></div><div style="text-align: left"><b><u><span style="font-size: 15pt"><br/>
</span></u></b></div></body></html>